{
    "sensitive-variables": [
        "vsphere_password",
        "winadmin_password"
    ],
    "builders": [
        {
            "type": "vsphere-iso",
            "vcenter_server": "{{user `vcenter_server`}}",
            "username": "{{user `vcenter_username`}}",
            "password": "{{user `vcenter_password`}}",
            "insecure_connection": "true",
            "datacenter": "{{user `vcenter_datacenter`}}",
            "cluster": "{{user `vcenter_cluster`}}",
            "datastore": "{{user `vcenter_datastore`}}",
            "folder": "{{user `vcenter_folder`}}",
            "communicator": "winrm",
            "winrm_username": "Administrator",
            "winrm_password": "{{user `winadmin-password`}}",
            "convert_to_template": "true",
            "vm_name": "{{user `vm-name`}}",
            "notes": "{{user `vm-notes`}}\nDefault User: Administrator\nDefault Pass: {{user `winadmin-password`}}\nBuilt by Packer @ {{isotime \"2006-01-02 03:04\"}}.",
            "CPUs": "{{user `vm-cpu-num`}}",
            "RAM": "{{user `vm-mem-size`}}",
            "RAM_reserve_all": true,
            "firmware": "efi-secure",
            "boot_wait": "70s",
            "configuration_parameters": {
                "remotedisplay.maxconnections": "2",
                "RemoteDisplay.vnc.enabled": "false",
                "sched.mem.pshare.salt": "false",
                "isolation.tools.ghi.autologon.disable": "true",
                "isolation.bios.bbs.disable": "true",
                "isolation.tools.getCreds.disable": "true",
                "isolation.tools.ghi.launchmenu.change": "true",
                "isolation.tools.memSchedFakeSampleStats.disable": "true",
                "isolation.tools.ghi.protocolhandler.info.disable": "true",
                "isolation.ghi.host.shellAction.disable": "true",
                "isolation.tools.unity.taskbar.disable": "true",
                "isolation.tools.dispTopoRequest.disable": "true",
                "isolation.tools.trashFolderState.disable": "true",
                "isolation.tools.ghi.trayicon.disable": "true",
                "isolation.tools.unity.disable": "true",
                "isolation.tools.unityActive.disable": "true",
                "isolation.tools.unityInterlockOperation.disable": "true",
                "isolation.tools.unity.push.update.disable": "true",
                "isolation.tools.vmxDnDVersionGet.disable": "true",
                "isolation.tools.guestDnDVersionSet.disable": "true",
                "isolation.tools.unity.windowContents.disable": "true",
                "isolation.tools.hgfsServerSet.disable": "true",
                "isolation.tools.autoInstall.disable": "false",
                "isolation.tools.diskShrink.disable": "true",
                "isolation.tools.diskWiper.disable": "true",
                "isolation.tools.vixMessage.disable": "true",
                "tools.guestlib.enableHostInfo": "false",
                "isolation.tools.copy.disable": "true",
                "isolation.tools.dnd.disable": "true",
                "isolation.tools.setGUIOptions.enable": "false",
                "isolation.tools.paste.disable": "true",
                "tools.setInfo.sizeLimit": "1048576",
                "isolation.device.connectable.disable": "true",
                "isolation.device.edit.disable": "true",
                "isolation.monitor.control.disable": "true",
                "logging": "false",
                "log.rotatesize": "1024000",
                "log.keepold": "9"
            },
            "tools_upgrade_policy": true,
            "boot_command": [
                "<tab><wait><enter><wait>",
                "a<wait>a<wait>a<wait>a<wait>a<wait>a<wait>"
            ],
            "cdrom_type": "sata",
            "disk_controller_type": "lsilogic-sas",
            "network_adapters": [
                {
                    "network": "{{user `vcenter_network`}}",
                    "network_card": "vmxnet3"
                }
            ],
            "storage": [
                {
                    "disk_size": "{{user `vm-disk-size`}}",
                    "disk_thin_provisioned": true
                }
            ],
            "iso_url": "{{user `iso_url`}}",
            "iso_checksum": "{{user `iso_checksum_type`}}:{{user `iso_checksum`}}",
            "iso_paths": [
                "[] /vmimages/tools-isoimages/windows.iso"
            ],
            "floppy_files": [
                "autounattend.xml",
                "../scripts/disable-network-discovery.cmd",
                "../scripts/enable-rdp.cmd",
                "../scripts/enable-winrm.ps1",
                "../scripts/install-vm-tools.cmd",
                "../scripts/set-temp.ps1",
                "../scripts/set-static-ip.ps1"
            ]
        }
    ],
    "provisioners": [
        {
            "type": "windows-shell",
            "inline": [
                "ipconfig"
            ]
        },
        {
            "type": "windows-update",
            "filters": [
                "include:$true"
            ]
        },
        {
            "type": "windows-restart"
        }
    ]
}