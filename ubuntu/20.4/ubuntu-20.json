{
    "builders": [
      {
        "type": "vsphere-iso",
  
        "vcenter_server":      "{{user `vcenter_server`}}",
        "username":            "{{user `username`}}",
        "password":            "{{user `password`}}",
        "insecure_connection": "true",
  
        "vm_name": "template_ubuntu18test",
        "datastore": "{{user `datastore`}}",
        "folder": "{{user `folder`}}",
        "convert_to_template": "true",
        "cluster": "{{user `cluster`}}",
        "boot_order": "disk,cdrom",
  
        "guest_os_type": "ubuntu64Guest",
  
        "ssh_username": "{{user `ssh_username`}}",
        "ssh_password": "{{user `ssh_password`}}",
  
        "CPUs":             2,
        "RAM":              2048,
        "RAM_reserve_all": true,
        "storage": [
          {
        "disk_size":        32768,
        "disk_thin_provisioned": true
        }],
        "network_adapters": [
          {
            "network": "{{user `network`}}",
            "network_card": "vmxnet3"
          }
        ],
        "iso_checksum": "sha256:443511f6bf12402c12503733059269a2e10dec602916c0a75263e5d990f6bb93", 
        "iso_urls": "http://releases.ubuntu.com/20.04/ubuntu-20.04.1-live-server-amd64.iso",
      
        "http_directory": "http",
        "boot_command": [
          "<esc><wait><esc><wait><f6><wait><esc><wait>",
          "<bs><bs><bs><bs><bs>",
          "autoinstall ds=nocloud-net;s=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ ",
          "--- <enter>"
        ]        
      }
    ],
    "provisioners": [{
      "type": "shell",
      "inline": [
        "while [ ! -f /var/lib/cloud/instance/boot-finished ]; do echo 'Waiting for cloud-init...'; sleep 1; done"
      ]
    }]
  }
